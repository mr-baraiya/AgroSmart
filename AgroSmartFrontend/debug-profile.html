<!DOCTYPE html>
<html>
<head>
    <title>Debug Profile Picture</title>
</head>
<body>
    <h2>Profile Picture Debug</h2>
    <div id="result"></div>
    <button onclick="updateUserData()">‚úÖ Update User Data with Profile Image</button>
    <button onclick="clearUserData()">üóëÔ∏è Clear User Data</button>
    <button onclick="testImageUrl()">üîç Test Image URL Construction</button>
    
    <script>
        // Test the image URL construction
        const profileImage = "Images/3df7d67f-dfac-4116-a29c-0938e5268d85.jpg";
        const baseUrl = "https://localhost:7059";
        const fullUrl = `${baseUrl}/${profileImage}`;
        
        console.log('Profile Image Path:', profileImage);
        console.log('Base URL:', baseUrl);
        console.log('Full URL:', fullUrl);
        
        function testImageUrl() {
            // Test if image loads
            const img = new Image();
            img.onload = function() {
                document.getElementById('result').innerHTML = `
                    <p style="color: green;">‚úÖ Image loads successfully!</p>
                    <p><strong>URL:</strong> ${fullUrl}</p>
                    <img src="${fullUrl}" style="max-width: 200px; border-radius: 50%; border: 2px solid green;">
                    <p><strong>Status:</strong> Ready for React frontend!</p>
                `;
            };
            img.onerror = function() {
                document.getElementById('result').innerHTML = `
                    <p style="color: red;">‚ùå Image failed to load</p>
                    <p><strong>URL:</strong> ${fullUrl}</p>
                    <p><strong>Issue:</strong> Check if backend is running on port 7059</p>
                `;
            };
            img.src = fullUrl;
        }
        
        // Auto-test on load
        testImageUrl();
        
        // Check localStorage
        const user = localStorage.getItem('user');
        console.log('Current user in localStorage:', user ? JSON.parse(user) : 'No user data');
        
        function updateUserData() {
            const userData = {
                "userId": 17,
                "name": "Vishal Baraiya",
                "fullName": "Baraiya Vishalbhai Vijaybhai",
                "email": "baraiyavishalbhai32@gmail.com",
                "phone": "7383359679",
                "role": "User",
                "profileImage": "Images/3df7d67f-dfac-4116-a29c-0938e5268d85.jpg"
            };
            
            localStorage.setItem('user', JSON.stringify(userData));
            console.log('‚úÖ Updated user data:', userData);
            alert('‚úÖ User data updated! Now refresh your React app (http://localhost:5173)');
            
            // Also show current state
            document.getElementById('result').innerHTML += `
                <div style="margin-top: 20px; padding: 10px; background: #f0f9ff; border: 1px solid #0ea5e9; border-radius: 5px;">
                    <h4>üìù Updated localStorage:</h4>
                    <pre style="font-size: 11px; overflow: auto;">${JSON.stringify(userData, null, 2)}</pre>
                    <p><strong>Next:</strong> Go to <a href="http://localhost:5173" target="_blank">http://localhost:5173</a> and login!</p>
                </div>
            `;
        }
        
        function clearUserData() {
            localStorage.removeItem('user');
            localStorage.removeItem('authToken');
            console.log('üóëÔ∏è User data cleared');
            alert('üóëÔ∏è User data cleared!');
            
            document.getElementById('result').innerHTML += `
                <div style="margin-top: 20px; padding: 10px; background: #fef2f2; border: 1px solid #ef4444; border-radius: 5px;">
                    <h4>üóëÔ∏è Cleared localStorage</h4>
                    <p>All user data and tokens removed.</p>
                </div>
            `;
        }
    </script>
</body>
</html>
